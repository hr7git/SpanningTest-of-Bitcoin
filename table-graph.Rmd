---
title: "reression"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



<center>**Diversification of Cryptocurrency after COVID-19**</center>

<center>**: Spanning Test of news asset **</center><br>


<br><center>**1.	Introduction**</center><br>

  Bitcoin is a decentralized digital money based on blockchain technology. It was born out of the need to maintain an objective currency value, independent of government control. Since the global financial crisis (2008), each country has increased money supply called Quantitative Easing (QE), and the rapid increase in fiat money has caused strong distrust of the government's monetary control and concerns about inflation. Therefore, the need for a new currency that is independent from the government's supply and cannot be issued infinitely increased, and Nakamoto (2009) created the cryptocurrency Bitcoin. Unfortunately, since the covid-19 pandemic in 2020, Quantitative Easing (QE) has led to currency depreciation and increased expectation for Bitcoin. Recently, the value of Bitcoin has risen sharply incomparably with the previous period.

  These expectations for Bitcoin have made comparisons with gold, a traditional safe-haven asset. Can Bitcoin really hedge against inflation from the government's Quantitative Easing (QE) policy? Can Bitcoin be a safe haven from market turmoil and uncertainties? Many studies have argued that Bitcoin is a short-term or not safe-haven for financial uncertainty and weak inflation-hedge. In addition, High volatility of returns has made it a risky asset. (Choi, S. and Shin, J. ,2021)

Fortunately, since Markowitz (1959) expressed the foundations for the modern portfolio theory, investors have come to recognize that a correlation between assets is more important than volatility of assets, and they realize that volatility can be reduced without compromising returns. Bitcoin can be a very risky investment due to its high volatility, but under Markowitz theory, the risk can be adjusted through the correlation with other assets. So far, stocks and real estate have a high correlation with each other, and stocks and bonds have a low correlation of 0.2 ~ 0.3. However, Bitcoin has very high volatility even in its short history, and has a correlation of 0.2 ~ 0.3 compared to the existing stock portfolio, and that correlation is getting lower now (Buttonwood, 2021). On the other hand, it shows profitability that exceeds that of bonds. Although past data cannot describe future expectations, these characteristics of Bitcoin can make it a very attractive alternative choice for portfolio managers.

Then, could these other characteristics make Bitcoin a completely different asset from traditional assets such as stocks, bonds, commodities, gold, and real estate?  In other words, if Bitcoin is added to an existing portfolio of assets, can it improve portfolio output? How can we verify this?

We examine whether new risky assets can expand investment opportunities for other sets of risky assets, and examine that when investors choose a portfolio based on mean-variance analysis, they can expand minimum-variance boundaries in a given set of risky assets (Huberman and Kandel, 1987).

The structure of this paper is as follows. Chapter2 reviews the papers examining the characteristics of Bitcoin by comparing cryptocurrency and gold, and papers examining the addition of new assets in investment portfolio theory. Chapter 3 explains the methodology used by Huberman and Kandel (1987) to compare the possibility of investment expansion when Bitcoin is included in the portfolio. Chapter 4 describes the results of empirical analysis. Chapter 5 presents a summary and conclusion  


```{r,echo=FALSE,message=FALSE }

library(dplyr)
library(readr)
library(car)
# library(lmtest)
library(tidyverse)
library(data.table)
library(knitr)
library(stringr)
library(interactions)
library(jtools)
library("ggplot2")
library(huxtable)
library("broom.mixed")
# library(kableExtra)
```


```{r, render = 'normal_print' }

# for loop ###########################################

data01 <- read.csv("data1225.csv")
data01 <- data01 %>% select(Date , contains("Tbill"), ends_with("R")) 
write.csv(data01, file = "temp.csv", row.names = F)

# excess return  = ratio - Tbill
for(i in 3:ncol(data01))  {
  
  data01[,i] = data01[,i] - data01$Tbill

}
data02 <- data01 %>% filter(Date < '2020-01-01') 
data03 <- data01 %>% filter(Date >= '2020-01-01')
data_j <- list(data01,data02,data03)



formula <- list(); formula_con <- list()

model      <- list(list(),list(),list())  
model_con  <- list(list(),list(),list()) 
HK_test    <- list(list(),list(),list())  
step1_test <- list(list(),list(),list()) 
step2_test <- list(list(),list(),list()) 

yi <- list("BTCUSDR","ETHUSDR","BNBUSDR")


for (i in 1:3)  {
    for (j in 1:3) {
      

    formula[[i]] = paste0(yi[i] , " ~ ", "VTIR + VVR + VBR + IDHQR + VWOR + BNDR",
                 "+ TIPR + GSGR + VNQR + VNQIR")
                
    model[[i]][[j]] <- lm(formula[[i]], data = data_j[[j]])  ###
    
    ##### HK test
    lhs <- rbind(c(1,0,0,0,0,0,0,0,0,0,0),c(0,1,1,1,1,1,1,1,1,1,1))
    HK_test[[i]][[j]] <- lht(model[[i]][[j]],lhs,c(0,1))
   
    ##### step-1 test  : alpha = 0
    lhs <- c(1,0,0,0,0,0,0,0,0,0,0)
    step1_test[[i]][[j]] <- lht(model[[i]][[j]],lhs,c(0))
    
    ##### step- test 2 : 
    ##### unresrticted model condition on alpha =0  
    formula_con[[i]] = paste0(yi[i] , " ~ ","0 + ", "VTIR + VVR + VBR + IDHQR ",
                          "+ VWOR + BNDR + TIPR + GSGR + VNQR + VNQIR")
        model_con[[i]][[j]] <- lm(formula_con[[i]], data = data_j[[j]])
        ##### step- test 2 : beta=1 condition alpha = 0
        lhs <- rbind(c(1,1,1,1,1,1,1,1,1,1))
        step2_test[[i]][[j]] <- lht(model_con[[i]][[j]],lhs,c(1))
    }
}


### Column nameing 
c1 <- c("BTCUSDR","ETHUSDR","BNBUSDR")

names(formula) <- c1
names(formula_con) <- c1
names(model) <- c1
names(model_con) <- c1
names(HK_test) <- c1
names(step1_test) <- c1
names(step2_test) <- c1
################################################################
################################################################
################################################################
################################################################
################################################################
################################################################
```


```{r, render = 'normal_print' }
formula
formula_con

kable( HK_test[[1]] )
kable( HK_test[[2]] )
kable( HK_test[[3]] )



for (i in 1:3)  {
  
  for (j in 1:3) {
    
    kable( HK_test[[i]][[j]]  )
    hux( step1_test[[i]][[j]]  )
    # print( step2_test[[i]][[j]]  )
    }
  
}

```


```{r, render = 'normal_print' }
summary(model[[2]][[1]])
summary(model$ETHUSDR[[1]])

```



```{r, render = 'normal_print' }
#########################################################
#############################################################################
#########################################################
#########################################################
#########################################################
#########################################################

summary(model[[1]][[1]])
summ(model[[1]][[1]],  digit = 3)

# plot_summs(model[[1]][[1]], scale = TRUE, plot.distributions = TRUE, inner_ci_level = .9)
# plot_summs(model[[1]][[1]], model[[1]][[2]], scale = TRUE)

# export_summs(model$BTCUSDR[[1]], model$BTCUSDR[[2]],model$BTCUSDR[[3]], scale = TRUE)
# export_summs(model$ETHUSDR[[1]], model$ETHUSDR[[2]],model$ETHUSDR[[3]], scale = TRUE)
# export_summs(model$BNBUSDR[[1]], model[[3]][[2]],model[[3]][[3]], scale = TRUE)

export_summs(model[[1]][[1]], model[[1]][[2]],model[[1]][[3]],
             model[[2]][[1]], model[[2]][[2]],model[[2]][[3]],
             model[[3]][[1]], model[[3]][[2]],model[[3]][[3]],
             model.names = c("BTC all","BTC before","BTC after",
                             "ETH all","ETH before","ETH after","BNB all","BNB before","BNB after"))

huxreg(model[[1]][[1]], model[[1]][[2]],model[[1]][[3]],
       model[[2]][[1]], model[[2]][[2]],model[[2]][[3]],
       model[[3]][[1]], model[[3]][[2]],model[[3]][[3]])

huxreg(model_con[[1]][[1]], model_con[[1]][[2]],model_con[[1]][[3]],
       model_con[[2]][[1]], model_con[[2]][[2]],model_con[[2]][[3]],
       model_con[[3]][[1]], model_con[[3]][[2]],model_con[[3]][[3]])

huxtable(HK_test[[1]][[1]])

hux(HK_test[[1]][[1]])  
hux(HK_test[[1]]) 
hux(HK_test)

kable(HK_test[[1]][[1]]) 
kable(HK_test[[1]]) 
kable(HK_test) 

HK_test[[1]][[1]]
HK_test[[1]]
HK_test

```

