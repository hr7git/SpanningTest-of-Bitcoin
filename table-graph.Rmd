---
title: "reression"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



<center>**Diversification of Cryptocurrency after COVID-19**</center>

<center>**: Spanning Test of news asset **</center><br>


<br><center>**1.	Introduction**</center><br>

  Bitcoin is a decentralized digital money based on blockchain technology. It was born out of the need to maintain an objective currency value, independent of government control. Since the global financial crisis (2008), each country has increased money supply called Quantitative Easing (QE), and the rapid increase in fiat money has caused strong distrust of the government's monetary control and concerns about inflation. Therefore, the need for a new currency that is independent from the government's supply and cannot be issued infinitely increased, and Nakamoto (2009) created the cryptocurrency Bitcoin. Unfortunately, since the covid-19 pandemic in 2020, Quantitative Easing (QE) has led to currency depreciation and increased expectation for Bitcoin. Recently, the value of Bitcoin has risen sharply incomparably with the previous period.




```{r,echo=FALSE,message=FALSE }

library(dplyr)
library(readr)
library(car)
# library(lmtest)
library(tidyverse)
library(data.table)
library(knitr)
library(stringr)
library(interactions)
library(jtools)
library("ggplot2")
library(huxtable)
library("broom.mixed")
# library(kableExtra)
```


```{r, echo=FALSE,render = 'normal_print' }

# # for loop ###########################################
# 
# data01 <- read.csv("data1225.csv")
# data01 <- data01 %>% select(Date , contains("Tbill"), ends_with("R")) 
# write.csv(data01, file = "temp.csv", row.names = F)
# 
# # excess return  = ratio - Tbill
# for(i in 3:ncol(data01))  {
#   
#   data01[,i] = data01[,i] - data01$Tbill
# 
# }
# data02 <- data01 %>% filter(Date < '2020-01-01') 
# data03 <- data01 %>% filter(Date >= '2020-01-01')
# data_j <- list(data01,data02,data03)
# 
# 
# 
# formula <- list(); formula_con <- list()
# 
# model      <- list(list(),list(),list())  
# model_con  <- list(list(),list(),list()) 
# HK_test    <- list(list(),list(),list())  
# step1_test <- list(list(),list(),list()) 
# step2_test <- list(list(),list(),list()) 
# 
# yi <- list("BTCUSDR","ETHUSDR","BNBUSDR")
# 
# 
# for (i in 1:3)  {
#     for (j in 1:3) {
#       
# 
#     formula[[i]] = paste0(yi[i] , " ~ ", "VTIR + VVR + VBR + IDHQR + VWOR + BNDR",
#                  "+ TIPR + GSGR + VNQR + VNQIR")
#                 
#     model[[i]][[j]] <- lm(formula[[i]], data = data_j[[j]])  ###
#     
#     ##### HK test
#     lhs <- rbind(c(1,0,0,0,0,0,0,0,0,0,0),c(0,1,1,1,1,1,1,1,1,1,1))
#     HK_test[[i]][[j]] <- lht(model[[i]][[j]],lhs,c(0,1))
#    
#     ##### step-1 test  : alpha = 0
#     lhs <- c(1,0,0,0,0,0,0,0,0,0,0)
#     step1_test[[i]][[j]] <- lht(model[[i]][[j]],lhs,c(0))
#     
#     ##### step- test 2 : 
#     ##### unresrticted model condition on alpha =0  
#     formula_con[[i]] = paste0(yi[i] , " ~ ","0 + ", "VTIR + VVR + VBR + IDHQR ",
#                           "+ VWOR + BNDR + TIPR + GSGR + VNQR + VNQIR")
#         model_con[[i]][[j]] <- lm(formula_con[[i]], data = data_j[[j]])
#         ##### step- test 2 : beta=1 condition alpha = 0
#         lhs <- rbind(c(1,1,1,1,1,1,1,1,1,1))
#         step2_test[[i]][[j]] <- lht(model_con[[i]][[j]],lhs,c(1))
#     }
# }
# 
# 
# ### Column nameing 
# c1 <- c("BTCUSDR","ETHUSDR","BNBUSDR")
# 
# names(formula) <- c1
# names(formula_con) <- c1
# names(model) <- c1
# names(model_con) <- c1
# names(HK_test) <- c1
# names(step1_test) <- c1
# names(step2_test) <- c1
################################################################
```


```{r,  render = 'normal_print' }
load("data1225.RData")

huxreg(model[[1]][[1]], model[[1]][[2]],model[[1]][[3]],
       model[[2]][[1]], model[[2]][[2]],model[[2]][[3]],
       model[[3]][[1]], model[[3]][[2]],model[[3]][[3]])

kable( HK_test )
kable( step1_test )
kable( step2_test )



```


```{r,  render = 'normal_print' }
summary(model[[2]][[1]])
summary(model$ETHUSDR[[1]])

```



```{r, render = 'normal_print' }


summary(model[[1]][[1]])
summ(model[[1]][[1]],  digit = 3)

# plot_summs(model[[1]][[1]], scale = TRUE, plot.distributions = TRUE, inner_ci_level = .9)
# plot_summs(model[[1]][[1]], model[[1]][[2]], scale = TRUE)

# export_summs(model$BTCUSDR[[1]], model$BTCUSDR[[2]],model$BTCUSDR[[3]], scale = TRUE)
# export_summs(model$ETHUSDR[[1]], model$ETHUSDR[[2]],model$ETHUSDR[[3]], scale = TRUE)
# export_summs(model$BNBUSDR[[1]], model[[3]][[2]],model[[3]][[3]], scale = TRUE)

export_summs(model[[1]][[1]], model[[1]][[2]],model[[1]][[3]],
             model[[2]][[1]], model[[2]][[2]],model[[2]][[3]],
             model[[3]][[1]], model[[3]][[2]],model[[3]][[3]],
             model.names = c("BTC all","BTC before","BTC after",
                             "ETH all","ETH before","ETH after","BNB all","BNB before","BNB after"))

huxreg(model[[1]][[1]], model[[1]][[2]],model[[1]][[3]],
       model[[2]][[1]], model[[2]][[2]],model[[2]][[3]],
       model[[3]][[1]], model[[3]][[2]],model[[3]][[3]])

huxreg(model_con[[1]][[1]], model_con[[1]][[2]],model_con[[1]][[3]],
       model_con[[2]][[1]], model_con[[2]][[2]],model_con[[2]][[3]],
       model_con[[3]][[1]], model_con[[3]][[2]],model_con[[3]][[3]])

# huxtable(HK_test[[1]][[1]])
# 
# hux(HK_test[[1]][[1]])  
# hux(HK_test[[1]]) 
# hux(HK_test)
# 
# kable(HK_test[[1]][[1]]) 
# kable(HK_test[[1]]) 
# kable(HK_test) 

HK_test[[1]][[1]]
HK_test[[1]]
HK_test

```

